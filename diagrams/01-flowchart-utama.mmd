flowchart TD
    A[ðŸ  User Buka Aplikasi] --> B[ðŸ“„ Halaman Upload KTP]
    B --> C{User Upload Gambar?}
    C -->|Tidak| B
    C -->|Ya| D[ðŸ–¼ï¸ Validasi File]
    
    D --> E{Format Valid?<br/>JPG/PNG/WebP}
    E -->|Tidak| F[âŒ Error: Format Salah]
    F --> B
    
    E -->|Ya| G{Ukuran â‰¤ 5MB?}
    G -->|Tidak| H[âŒ Error: File Terlalu Besar]
    H --> B
    
    G -->|Ya| I[âœ… Tampilkan Preview]
    I --> J{User Klik Ekstrak?}
    J -->|Tidak| K{User Klik Reset?}
    K -->|Ya| B
    K -->|Tidak| J
    
    J -->|Ya| L[â³ Loading: Proses OCR]
    L --> M[ðŸ¤– Kirim ke Gemini API]
    M --> N{Response OK?}
    
    N -->|Error| O[âŒ Error Popup]
    O --> B
    
    N -->|OK| P{Gambar adalah KTP?}
    P -->|Tidak| Q[âŒ Error: Bukan KTP]
    Q --> B
    
    P -->|Ya| R[âœ… Tampilkan Hasil Ekstraksi]
    R --> S{User Action?}
    
    S -->|Salin JSON| T[ðŸ“‹ Copy ke Clipboard]
    T --> S
    
    S -->|Download| U[ðŸ’¾ Download JSON File]
    U --> S
    
    S -->|Upload Baru| B
