sequenceDiagram
    participant U as ğŸ‘¤ User
    participant F as ğŸŒ Frontend
    participant B as âš™ï¸ Backend
    participant G as ğŸ¤– Gemini API
    
    U->>F: Upload Foto KTP
    F->>F: Validasi Format & Ukuran
    
    alt File Invalid
        F-->>U: âŒ Error Popup
    else File Valid
        F->>F: Tampilkan Preview
        U->>F: Klik Ekstrak Data
        F->>F: Tampilkan Loading
        F->>B: POST /api/extract-ktp
        
        B->>B: Validasi File
        B->>B: Process Image
        B->>G: Kirim Gambar + Prompt
        
        G->>G: Analisis Gambar
        
        alt Bukan KTP
            G-->>B: is_ktp false
            B-->>F: success false
            F-->>U: âŒ Error Bukan KTP
        else KTP Valid
            G-->>B: is_ktp true + data
            B-->>F: success true + data
            F-->>U: âœ… Tampilkan Hasil
        end
    end
    
    opt User Actions
        U->>F: Klik Salin JSON
        F-->>U: âœ… JSON Copied
        
        U->>F: Klik Download
        F-->>U: ğŸ’¾ Download File
    end
